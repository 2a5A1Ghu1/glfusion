function YouTubeGetID(e){var t="";e=e.replace(/(>|<)/gi,"").split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/)/);if(e[2]!==undefined){t=e[2].split(/[^0-9a-z\-_]/i);t=t[0]}else{t=e}return t}(function(){CKEDITOR.plugins.add("youtube2",{lang:["en"],init:function(e){e.addCommand("youtube2",new CKEDITOR.dialogCommand("youtube2",{allowedContent:"iframe[!width,!height,!src,!frameborder,!allowfullscreen]; object param[*]"}));e.ui.addButton("Youtube2",{label:e.lang.youtube2.button,toolbar:"insert",command:"youtube2",icon:this.path+"images/icon.png"});CKEDITOR.dialog.add("youtube2",function(t){var n;return{title:e.lang.youtube2.title,minWidth:500,minHeight:100,contents:[{id:"youtube2Plugin",expand:true,elements:[{id:"txtEmbed",type:"textarea",label:e.lang.youtube.txtEmbed,autofocus:"autofocus",validate:function(){if(this.isEnabled()){if(!this.getValue()){alert(e.lang.youtube.noCode);return false}else if(this.getValue().length===0||this.getValue().indexOf("//")===-1){alert(e.lang.youtube.invalidEmbed);return false}}}},{type:"hbox",widths:["15%","15%","15%","15%"],children:[{type:"text",id:"txtWidth",width:"60px",label:e.lang.youtube2.txtWidth,"default":e.config.youtube_width!=null?e.config.youtube_width:"560",validate:function(){if(this.getValue()){var t=parseInt(this.getValue())||0;if(t===0){alert(e.lang.youtube2.invalidWidth);return false}}else{alert(e.lang.youtube2.noWidth);return false}}},{type:"text",id:"txtHeight",width:"60px",label:e.lang.youtube2.txtHeight,"default":e.config.youtube_height!=null?e.config.youtube_height:"315",validate:function(){if(this.getValue()){var t=parseInt(this.getValue())||0;if(t===0){alert(e.lang.youtube2.invalidHeight);return false}}else{alert(e.lang.youtube2.noHeight);return false}}},{id:"txtAlign",type:"select",label:e.lang.youtube2.txtAlign,items:[[e.lang.youtube2.left,"left"],[e.lang.youtube2.right,"right"],[e.lang.youtube2.center,"center"]]},{id:"txtPad",type:"text",width:"60px","default":"0",label:e.lang.youtube2.txtPad}]}]}],onOk:function(){var e="";var t="";var n=this.getValueOf("youtube2Plugin","txtWidth");var r=this.getValueOf("youtube2Plugin","txtHeight");var i=this.getValueOf("youtube2Plugin","txtEmbed");var s=this.getValueOf("youtube2Plugin","txtPad");var o=YouTubeGetID(i);t+=" width:"+n;t+=" height:"+r;alignment=this.getContentElement("youtube2Plugin","txtAlign").getValue();if(alignment){t+=" align:"+alignment}if(s>0){t+=" pad:"+s}e+="[youtube:"+o+" "+t+"]";var u=this.getParentEditor();u.insertHtml(e)}}})}})})()