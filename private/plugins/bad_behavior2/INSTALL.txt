
Bad Behavior2 Plugin v2.0.13 for Geeklog v1.4.x
 - Bad Behavior 2 is Copyright (c) 2005-2008 Michael Hampton.
                                             All rights reserved.
   Original Geeklog Plugin by Dirk Haun
   Bad Behavior2 Plugin Upgrade by Mark R. Evans

Bad Behavior complements other link spam solutions by acting as a gatekeeper,
preventing spammers from ever delivering their junk, and in many cases, from
ever reading your site in the first place. This keeps your site’s load down,
makes your site logs cleaner, and can help prevent denial of service
conditions caused by spammers.
(quoted from <http://www.bad-behavior.ioerror.us/>)

INSTALLATION

(For upgrading instructions, see below)

With one exception (see step 5), this plugin installs like any other Geeklog
plugin:

1) Unpack bad_behavior2_2.0.13-1.4.1.tar.gz
2) Upload the contents of the public_html directory into
   /path/to/geeklog/public_html/bad_behavior2
3) Upload the contents of the admin directory into
   /path/to/geeklog/public_html/admin/plugins/bad_behavior2
4) Upload the functions.inc file and language directory into
   /path/to/geeklog/plugins/bad_behavior2
5) Upload the contents of the templates directory into
   /path/to/geeklog/plugins/bad_behavior2/templates

***** IMPORTANT! EXTRA STEP FOR THIS PLUGIN *****

6) Edit your lib-common.php file. Find the line where the lib-database.php is
   included:

   require_once( $_CONF['path_system'] . 'lib-database.php' );

   AFTER that line, add:

    if (DB_count($_TABLES['plugins'], array("pi_name","pi_enabled"),array("bad_behavior2","1")) > 0) {
        require_once($_CONF['path_html'] . 'bad_behavior2/bad-behavior-geeklog.php');
    }

7) Log in as the Admin, select "Plugins" from the Admin block and click on
   "Install" for the bad_behavior2 plugin

If you need help with installing a Geeklog plugin, start here:
<http://www.geeklog.net/forum/viewtopic.php?showtopic=39765>


UPGRADING

If you are upgrading from v2.0.10 or v2.0.11, you simply need to copy the
files over the existing Bad Behavior2 files on your system and then run
the Update routine from Geeklog's Plugin Manager.

If you are upgrading from v1.2.4-1 you must first uninstall the existing
plugin before you install v2.0.13.

  - Perform a standard plugin uninstall - Plugins -> Bad Behavior - Delete
  - Do not forget to remove the Bad Behavior 1 lib-common.php entry
  - Do not forget to remove the Bad Behavior 1 Spam-X module
       Remove /path/to/geeklog/plugins/spamx/BadBehavior.Action.class.php
       Subtract the value of 64 from the entry in $_CONF['spamx'] in
          Geeklog's main config.php file.


CONFIGURATION

There is only one configuration option with Bad Behavior2, the 'strict'
option.

To change the configuration option, you will need to edit the
    public_html/bad_behavior2/bad-behavior-geeklog.php file

Near the top you will see:

    $bb2_settings_defaults = array(
    	'log_table'     => $_DB_table_prefix . 'bad_behavior2',
    	'display_stats' => true,
    	'strict'        => false,
    	'verbose'       => false
    );

The only option you should change is the 'strict' option.

strict: Enables strict mode blocking. When turned on, certain types of
        spam will be blocked, but legitimate corporate and government users
        may also be blocked. This is off by default.

Spam-X module

This version of Bad Behavior does not include the Spam-X module.
Bad Behavior2 no longer bans by IP, instead it checks each HTTP request, so
the Spam-X module is no longer useful since IPs are no longer banned.

Searching

Users in the Bad Behavior2 Admin group can search the Bad Behavior2 logs.
Simply go to Geeklog's search page and enter your search terms. Select
"Bad Behavior2" from the "Type" drop-down menu if you only want to perform a
search on the Bad Behavior2 logs.

The search function will search for IP addresses and it also searches through
the entire HTTP request that the offender used to access the site.

Stats

Bad Behavior2 also displays a section in your site's statistics. In addition
to the total number of blocked requests, it also displays a list of the most
common misbehaviors. These statistics are only visible to members of the
'Bad Behavior2 Admin' group.

PHP Block for Stats

A PHP block function is available if you would like to show the number of
attempts that have been blocked by Bad Behavior2.

The function name is: phpblock_bad_behavior2_stats

Create a standard Geeklog block with a type of PHP and include the function
name above.

Changes

Bad Behavior2 2.0.13
 - Added the IP address of digg.com services to the whitelist.
 - Fixed a bug in the blacklist user-agent code that caused the
   matches to be case insensitive when they should have been
   case sensitive.

Bad Behavior2 2.0.11
 - Fixes an issue with the blackhole lookup always returning
   a bad IP (banned).
 - A couple of small bug fixes in Bad Behavior's code.

Bad Behavior2 2.0.10 upgrades the core Bad Behavior code to v2.0.10.
This version also names everything Bad Behavior2 to avoid conflicts
with the original v1.2.4-1 plugin by Dirk Haun.
 - Required Geeklog v1.4.0 or later
 - Removed Spam-X module
 - Removed Un-block IP option (no longer needed)
 - Added PHP block function

New Features in Bad Behavior v2.0.10

- Bad Behavior 2 is faster than Bad Behavior 1, whether you use database
  logging or not. It has been completely redesigned from the ground up to
  be as fast as possible and provide protection on very high traffic sites,
  such as when you find yourself on the front page of slashdot.org, or
  you're the sysop of Wikipedia. For most requests, Bad Behavior 2 issues
  at most one fast database query, and in many cases, no database queries.
  Bad Behavior's run time on fast servers is measured in single
  milliseconds.

- Bad Behavior 2 has been enhanced with additional checks for spammers who
  have started or increased their activity in the last year. It also has
  better screening of trackback spam, killing virtually all of it.
  Bad Behavior 1 permitted a lot of trackback spam.

- Some spam delivery methods are easily confused with legitimate users,
  especially those in large corporations or governments. This is mainly
  due to the proxies in use at those places. When a spammer uses such a
  proxy, Bad Behavior cannot easily tell whether the request is legitimate
  or not. In Bad Behavior 1, these requests were blocked, causing many
  legitimate users to be blocked. In Bad Behavior 2, you can choose whether
  to block these requests with the 'strict' option.

- A new blocking method using realtime blackhole lists is being used to
  determine if a post originates from a known spam source, open proxy,
  etc. GET requests are not screened. Links are provided to blackhole list
  removal procedures through the fix it yourself link.

Credits

Bad Behavior was written by Michael Hampton.

This Geeklog plugin provides a wrapper around Michael's plugin and adds
a few Geeklog-specific extras, e.g. the ability to view the blocked requests
and to search through the list of blocked requests.

Copyright

Bad Behavior is (c) 2005-2008 by Michael Hampton and released under the GPL
The Geeklog plugin is (c) 2005-2008 Dirk Haun and also released under the GPL
Upgrade to Bad Behavior v2.0.10-2.0.13 by Mark Evans - GPL'ed of couse...

Please see the included file COPYING (in public_html) for license details.